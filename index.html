<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaVault | Your Ultimate Cinema Universe</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e50914">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CinemaVault">
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="apple-touch-icon" href="assets/favicon.svg">
    <meta name="msapplication-TileColor" content="#e50914">
    <meta name="msapplication-TileImage" content="assets/favicon.svg">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="CinemaVault - Your ultimate cinema universe. Stream and download high-quality movies, dramas, anime, software and games for free.">
    <meta name="keywords" content="movies, dramas, anime, software, games, download, stream, free, HD, CinemaVault, cinema">
    <meta name="author" content="CinemaVault">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="CinemaVault - Your Ultimate Cinema Universe">
    <meta property="og:description" content="Stream and download high-quality movies, dramas, anime, software and games for free.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://moviesaviour.netlify.app/">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/101418/e50914?text=CinemaVault">
    
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CinemaVault - Your Ultimate Cinema Universe">
    <meta name="twitter:description" content="Stream and download high-quality movies, dramas, anime, software and games for free.">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/101418/e50914?text=CinemaVault">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
                <img src="assets/logo.svg" alt="CinemaVault" class="logo-image">
            </a>

            <div class="mobile-icons">
                <button class="search-toggle-btn" aria-label="toggle search"><i class="fas fa-search"></i></button>
                <button class="nav-toggle" aria-label="toggle navigation">
                    <span class="hamburger"></span>
                </button>
            </div>

            <nav>
                <ul>
                    <li><a href="#" class="category-link active" data-category="all">All</a></li>
                    <li><a href="#" class="category-link" data-category="watchlist">My Watchlist</a></li>
                    <li class="dropdown">
                        <a href="#" class="category-link" data-category="movie">Movie</a>
                        <div class="dropdown-content">
                            <a href="index.html" class="category-link" data-category="Bangla">Bangla</a>
                            <a href="index.html" class="category-link" data-category="Bollywood">Bollywood</a>
                            <a href="index.html" class="category-link" data-category="Chinese Movie">Chinese</a>
                            <a href="index.html" class="category-link" data-category="Hollywood">Hollywood</a>
                            <a href="index.html" class="category-link" data-category="Japanese Movie">Japanese</a>
                            <a href="index.html" class="category-link" data-category="Korean Movie">Korean</a>
                            <a href="index.html" class="category-link" data-category="South Indian">South Indian</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="category-link" data-category="drama">Drama & Series</a>
                        <div class="dropdown-content">
                            <a href="index.html" class="category-link" data-category="Chinese Drama">Chinese Drama</a>
                            <a href="index.html" class="category-link" data-category="English Series">English Series</a>
                            <a href="index.html" class="category-link" data-category="Korean Drama">Korean Drama</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="category-link" data-category="anime">Anime</a>
                        <div class="dropdown-content">
                            <a href="index.html" class="category-link" data-category="Japanese Anime">Japanese Anime</a>
                            <a href="index.html" class="category-link" data-category="Chinese Anime">Chinese Anime</a>
                        </div>
                    </li>
                    <li><a href="#" class="category-link" data-category="software">Software</a></li>
                    <li class="dropdown">
                        <a href="#" class="category-link" data-category="game">Game</a>
                        <div class="dropdown-content">
                            <a href="index.html" class="category-link" data-category="Racing">Racing</a>
                        </div>
                    </li>
                    <li><a href="admin-login.html" class="admin-link"><i class="fas fa-user-shield"></i> Admin</a></li>
                </ul>
            </nav>
            
            <div class="search-container">
                <div class="search-wrapper">
                    <input type="text" id="searchInput" placeholder="Search for titles...">
                    <div class="search-filters" id="searchFilters">
                        <select id="genreFilter">
                            <option value="">All Genres</option>
                            <option value="Action">Action</option>
                            <option value="Drama">Drama</option>
                            <option value="Comedy">Comedy</option>
                            <option value="Horror">Horror</option>
                            <option value="Romance">Romance</option>
                            <option value="Thriller">Thriller</option>
                            <option value="Sci-Fi">Sci-Fi</option>
                            <option value="Animation">Animation</option>
                        </select>
                        <select id="yearFilter">
                            <option value="">All Years</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                            <option value="2020">2020</option>
                        </select>
                        <select id="ratingFilter">
                            <option value="">All Ratings</option>
                            <option value="9">9+ Rating</option>
                            <option value="8">8+ Rating</option>
                            <option value="7">7+ Rating</option>
                            <option value="6">6+ Rating</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div id="homepage-content">
            <!-- Trending Section -->
            <section class="trending-section">
                <div class="trending-badge">ðŸ”¥ Trending Now</div>
                <div class="category-row-header">
                    <h2 class="category-row-title">What's Hot Right Now</h2>
                </div>
                <div class="video-grid" id="trending-grid"></div>
            </section>

            <!-- Recently Added Section -->
            <section class="category-row" id="recent-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Recently Added</h2>
                    <a href="#" class="see-all-link category-link" data-category="recent">See all &raquo;</a>
                </div>
                <div class="video-grid" id="recent-grid"></div>
            </section>

            <section class="category-row" id="movie-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Movie</h2>
                    <a href="#" class="see-all-link category-link" data-category="movie">See all &raquo;</a>
                </div>
                <div class="video-grid" id="movie-grid"></div>
            </section>
            <section class="category-row" id="drama-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Drama</h2>
                    <a href="#" class="see-all-link category-link" data-category="drama">See all &raquo;</a>
                </div>
                <div class="video-grid" id="drama-grid"></div>
            </section>
            <section class="category-row" id="anime-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Anime</h2>
                    <a href="#" class="see-all-link category-link" data-category="anime">See all &raquo;</a>
                </div>
                <div class="video-grid" id="anime-grid"></div>
            </section>
            <section class="category-row" id="software-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Software</h2>
                    <a href="#" class="see-all-link category-link" data-category="software">See all &raquo;</a>
                </div>
                <div class="video-grid" id="software-grid"></div>
            </section>
            <section class="category-row" id="game-section">
                <div class="category-row-header">
                    <h2 class="category-row-title">Game</h2>
                    <a href="#" class="see-all-link category-link" data-category="game">See all &raquo;</a>
                </div>
                <div class="video-grid" id="game-grid"></div>
            </section>
        </div>
        
        <div id="single-category-content" style="display: none;">
            <div class="category-header">
                <h2 id="category-title"></h2>
                <div class="view-controls">
                    <div class="sort-controls">
                        <select id="sortSelect">
                            <option value="title">Sort by Title</option>
                            <option value="year">Sort by Year</option>
                            <option value="rating">Sort by Rating</option>
                            <option value="genre">Sort by Genre</option>
                        </select>
                    </div>
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="grid" title="Grid View">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" data-view="list" title="List View">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div id="loader"></div>
            <div class="video-grid" id="single-video-grid"></div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 CinemaVault. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="js/videos.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/script.js"></script>
    <script src="js/main.js"></script>
    <script src="js/content-manager.js"></script>
    
    <!-- Admin Access (removed old floating button since we now have proper login) -->
    <script>
        // Check if admin is logged in and show admin features
        document.addEventListener('DOMContentLoaded', function() {
            const isAdminLoggedIn = localStorage.getItem('cinemavault-admin') === 'true';
            const adminLoginTime = localStorage.getItem('cinemavault-admin-time');
            const currentTime = Date.now();
            const sessionDuration = 24 * 60 * 60 * 1000; // 24 hours
            
            // If admin is logged in and session is valid, show admin features
            if (isAdminLoggedIn && adminLoginTime && (currentTime - parseInt(adminLoginTime)) < sessionDuration) {
                // Update admin link to show as logged in
                const adminLink = document.querySelector('.admin-link');
                if (adminLink) {
                    const adminUser = localStorage.getItem('cinemavault-admin-user') || 'Admin';
                    adminLink.innerHTML = `<i class="fas fa-cog"></i> ${adminUser} Panel`;
                    adminLink.href = 'content-manager.html';
                    adminLink.style.background = 'var(--color-primary)';
                    adminLink.style.color = 'white';
                }
            }
        });
        
        // Function to manually refresh cache if needed
        function refreshCache() {
            if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage({ type: 'REFRESH_CACHE' });
                setTimeout(() => {
                    window.location.reload(true);
                }, 100);
            } else {
                window.location.reload(true);
            }
        }
        
        // Add keyboard shortcut for cache refresh (Ctrl+Shift+R alternative)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'U') {
                e.preventDefault();
                refreshCache();
            }
        });
    </script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker installed, refresh to get latest content
                                    console.log('New content available, refreshing...');
                                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                                    window.location.reload();
                                }
                            });
                        });
                        
                        // Listen for controlling service worker change
                        navigator.serviceWorker.addEventListener('controllerchange', () => {
                            window.location.reload();
                        });
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
